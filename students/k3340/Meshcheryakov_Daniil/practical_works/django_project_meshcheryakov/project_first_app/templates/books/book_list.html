{% extends "base.html" %}

{% block title %}–ö–∞—Ç–∞–ª–æ–≥ –∫–Ω–∏–≥{% endblock %}

{% block content %}
  <h1 class="mb-4 text-center">üìö –ö–∞—Ç–∞–ª–æ–≥ –∫–Ω–∏–≥</h1>

  <!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ -->
  <form method="get" class="d-flex mb-4">
    <input
      type="text"
      name="q"
      class="form-control me-2"
      placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –∞–≤—Ç–æ—Ä—É..."
      value="{{ query }}"
    />
    <button class="btn btn-primary" type="submit">üîç –ù–∞–π—Ç–∏</button>
  </form>

  <!-- –¢–∞–±–ª–∏—Ü–∞ -->
  <div class="table-responsive shadow-sm">
    <table class="table table-striped table-hover align-middle">
      <thead class="table-dark text-center">
        <tr>
          <th>#</th>
          <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
          <th>–ê–≤—Ç–æ—Ä</th>
          <th>–ì–æ–¥</th>
        </tr>
      </thead>
      <tbody>
        {% for book in page_obj %}
        <tr>
          <td class="text-center">{{ forloop.counter }}</td>
          <td>
            <a href="{% url 'book_detail' book.id %}" class="text-decoration-none">
              {{ book.title }}
            </a>
            {% if not book.available %}
              <span class="badge bg-danger ms-2">–ó–∞–Ω—è—Ç–∞</span>
            {% else %}
              <span class="badge bg-success ms-2">–î–æ—Å—Ç—É–ø–Ω–∞</span>
            {% endif %}
          </td>
          <td>{{ book.author }}</td>
          <td class="text-center">{{ book.year }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4" class="text-center text-muted py-3">–ù–µ—Ç –∫–Ω–∏–≥ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
  {% if page_obj.has_other_pages %}
  <nav aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º" class="mt-4">
    <ul class="pagination justify-content-center">
      {% if page_obj.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if query %}&q={{ query }}{% endif %}">‚Üê –ù–∞–∑–∞–¥</a>
      </li>
      {% else %}
      <li class="page-item disabled"><span class="page-link">‚Üê –ù–∞–∑–∞–¥</span></li>
      {% endif %}

      {% for num in page_obj.paginator.page_range %}
      {% if page_obj.number == num %}
      <li class="page-item active"><span class="page-link">{{ num }}</span></li>
      {% else %}
      <li class="page-item"><a class="page-link" href="?page={{ num }}{% if query %}&q={{ query }}{% endif %}">{{ num }}</a></li>
      {% endif %}
      {% endfor %}

      {% if page_obj.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if query %}&q={{ query }}{% endif %}">–í–ø–µ—Ä—ë–¥ ‚Üí</a>
      </li>
      {% else %}
      <li class="page-item disabled"><span class="page-link">–í–ø–µ—Ä—ë–¥ ‚Üí</span></li>
      {% endif %}
    </ul>
  </nav>
  {% endif %}
{% endblock %}
