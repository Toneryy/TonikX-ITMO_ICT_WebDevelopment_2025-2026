{% extends "base.html" %}

{% block title %}–ê–∫—Ç–∏–≤–Ω—ã–µ —á–∏—Ç–∞—Ç–µ–ª–∏{% endblock %}

{% block content %}
<div class="row">
  <div class="col-12">
    <h1 class="mb-4 text-center">üë• –ê–∫—Ç–∏–≤–Ω—ã–µ —á–∏—Ç–∞—Ç–µ–ª–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü</h1>

    <div class="alert alert-info">
      <strong>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong> –ù–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ —á–∏—Ç–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—Ä–∞–ª–∏ –∫–Ω–∏–≥–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π.
    </div>

    {% if borrowings %}
      <div class="table-responsive shadow-sm">
        <table class="table table-striped table-hover">
          <thead class="table-dark">
            <tr>
              <th>#</th>
              <th>–ß–∏—Ç–∞—Ç–µ–ª—å</th>
              <th>Email</th>
              <th>–ö–Ω–∏–≥–∞</th>
              <th>–ê–≤—Ç–æ—Ä</th>
              <th>–î–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∏—è</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
            </tr>
          </thead>
          <tbody>
            {% for b in borrowings %}
            <tr>
              <td class="text-center">{{ forloop.counter }}</td>
              <td>
                <a href="{% url 'reader_detail' b.reader.id %}" class="text-decoration-none">
                  {{ b.reader }}
                </a>
              </td>
              <td>{{ b.reader.email }}</td>
              <td>
                <a href="{% url 'book_detail' b.book.id %}" class="text-decoration-none">
                  {{ b.book.title }}
                </a>
              </td>
              <td>{{ b.book.author }}</td>
              <td>{{ b.date_from|date:"d.m.Y" }}</td>
              <td>
                {% if b.is_returned %}
                  <span class="badge bg-success">‚úÖ –í–æ–∑–≤—Ä–∞—â–µ–Ω–∞</span>
                {% else %}
                  <span class="badge bg-warning text-dark">üìñ –£ —á–∏—Ç–∞—Ç–µ–ª—è</span>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
      <div class="row mt-4">
        <div class="col-md-4">
          <div class="card text-center shadow-sm">
            <div class="card-body">
              <h5 class="card-title">–í—Å–µ–≥–æ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–π</h5>
              <p class="display-6 text-primary">{{ borrowings.count }}</p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card text-center shadow-sm">
            <div class="card-body">
              <h5 class="card-title">–ê–∫—Ç–∏–≤–Ω—ã—Ö</h5>
              <p class="display-6 text-warning">
                {{ borrowings|length }}
              </p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card text-center shadow-sm">
            <div class="card-body">
              <h5 class="card-title">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —á–∏—Ç–∞—Ç–µ–ª–µ–π</h5>
              <p class="display-6 text-success">
                {% with readers=borrowings|length %}
                  {% regroup borrowings by reader as reader_list %}
                  {{ reader_list|length }}
                {% endwith %}
              </p>
            </div>
          </div>
        </div>
      </div>
    {% else %}
      <div class="alert alert-warning text-center py-5">
        <h4>üò¥ –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü –Ω–µ –±—ã–ª–æ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–π</h4>
        <p>–ü–æ–∫–∞ –Ω–∏–∫—Ç–æ –Ω–µ –±—Ä–∞–ª –∫–Ω–∏–≥–∏. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
        <a href="{% url 'book_list' %}" class="btn btn-primary mt-3">
          –ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–∞—Ç–∞–ª–æ–≥—É –∫–Ω–∏–≥
        </a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}

